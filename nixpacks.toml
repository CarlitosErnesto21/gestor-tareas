[variables]
NIXPACKS_NO_CACHE = "1"
SKIP_LARAVEL_CACHE = "true"

[phases.build]
cmds = ["npm run build"]

[phases.install]
cmds = ["composer install --optimize-autoloader --no-dev --no-scripts"]

[phases.setup]
cmds = ["mkdir -p storage/framework/{sessions,views,cache,testing} storage/logs bootstrap/cache", "chmod -R 777 storage bootstrap/cache"]

[start]
cmd = "php artisan config:clear && php artisan route:clear && php artisan view:clear && php artisan migrate --force && php artisan serve --host=0.0.0.0 --port=$PORT"
